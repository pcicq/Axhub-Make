<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>{{TITLE}} - Spec</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    /* 全局样式 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      width: 100%;
      min-height: 100%;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
    }

    #spec-root {
      width: 100%;
      min-height: 100vh;
    }

    /* 加载状态 */
    .loading {
      /*text-align: center;*/
      padding: 60px 20px;
      color: #8c8c8c;
    }

    .loading::after {
      content: '...';
      animation: loading 1.5s infinite;
    }

    @keyframes loading {

      0%,
      20% {
        content: '.';
      }

      40% {
        content: '..';
      }

      60%,
      100% {
        content: '...';
      }
    }

    /* 错误状态 */
    .error {
      color: #ff4d4f;
      padding: 20px;
      background: #fff2f0;
      border: 1px solid #ffccc7;
      border-radius: 4px;
      margin: 20px;
    }

    .error h2 {
      margin-top: 0;
    }
  </style>
</head>

<body>
  <div id="spec-root" class="loading">加载中</div>

  <!-- 加载 bootstrap JS（会自动挂载到 window.SpecTemplateBootstrap） -->
  <script type="module" src="/assets/spec-template-bootstrap.js"></script>

  <script type="module">
    // 等待 bootstrap 加载完成
    function waitForBootstrap() {
      if (window.SpecTemplateBootstrap) {
        const { loadMarkdownFromUrl } = window.SpecTemplateBootstrap;

        console.log('[Spec Template] Bootstrap 已就绪');

        // 从 URL 参数或默认路径加载 Markdown
        const urlParams = new URLSearchParams(window.location.search);
        const specUrl = urlParams.get('url') || '{{SPEC_URL}}';

        console.log('[Spec Template] 加载 Spec:', specUrl);

        // 加载并渲染 Markdown
        loadMarkdownFromUrl(specUrl).catch(err => {
          console.error('[Spec Template] 加载失败:', err);
        });
      } else {
        setTimeout(waitForBootstrap, 10);
      }
    }

    waitForBootstrap();
  </script>

</body>

</html>