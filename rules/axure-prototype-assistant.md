# Axure 原型处理助手规范

本文档定义了如何使用 Axhub MCP 工具帮助用户从 Axure 原型中提取资产（主题、数据、文档）以及进行页面还原和优化的完整工作流程。

## 🎯 核心能力

通过 Axhub MCP，我们可以为用户提供以下服务：

1. **提取原型资产**
   - 站点地图（sitemap）
   - 设计主题（theme tokens）
   - 数据模型（data models）
   - 项目文档（documentation）

2. **页面还原与优化**
   - 基于截图的视觉还原
   - 结合主题、文本、节点的精确还原
   - 页面优化建议

## 📋 工作流程

### 阶段 0：环境检测

#### 0.1 检测 MCP 安装状态
尝试调用任意 MCP 工具（如 `get_axure_sitemap`），如果失败则提示用户安装 Axhub MCP。

#### 0.2 检测原型索引状态（可选）
使用 `search_axure` 测试原型是否已索引。未索引不影响流程，但建议用户索引以获得更好的搜索体验。

### 阶段 1：获取原型链接

如果用户未提供原型链接，提示用户提供 Axure 原型的 URL。

### 阶段 2：获取站点地图

使用 `get_axure_sitemap` 获取原型的完整页面结构，识别页面层级关系、统计页面数量、识别核心页面。

### 阶段 3：明确用户需求

如果用户未明确需求，提供默认建议：提取设计主题、数据模型、项目文档，并还原 1-2 个示例页面。根据用户反馈调整执行计划。

### 阶段 4：提取设计主题

#### 4.1 选择核心页面

从站点地图选择 3-5 个核心页面用于主题提取：

**选择策略**：
- 优先选择首页、登录页、主要功能页
- 选择视觉元素丰富的页面（避免纯文本页）
- 确保页面风格具有代表性

#### 4.2 提取并合并主题

1. 对每个选定页面使用 `get_page_theme` 提取主题数据
2. 合并多个页面的主题数据：
   - 颜色：统计出现频率，保留主要色系
   - 字体：识别主要字体族和字号
   - 间距、圆角、阴影：提取常用值

#### 4.3 生成主题文件

生成符合 `theme-generation-guide.md` 规范的主题文件：

**输出位置**：`src/themes/<theme-key>/`
**必需文件**：
- `designToken.json`：主题 token（必须包含 `name` 字段）
- `index.tsx`：主题演示页（使用 `ConfigProvider` 注入主题）

**关键要求**：
- 主题提取和演示页作为统一输出
- 必须包含基础 token（颜色、字体、间距等）
- 演示页应自动分组展示所有 token

### 阶段 5：提取数据模型

#### 5.1 识别数据密集型页面

从站点地图中识别可能包含数据的页面：
- 列表页（用户列表、订单列表等）
- 表单页（用户信息、订单详情等）
- 详情页（包含结构化信息的页面）

**识别方法**：
- 通过页面名称判断
- 使用 `search_axure` 搜索相关页面

#### 5.2 提取并分析数据

1. 使用 `get_axure_text` 提取页面文本内容
2. 从文本中识别数据结构：
   - 表格列名 → 数据字段
   - 表单标签 → 数据字段
   - 重复模式 → 数据列表

#### 5.3 跨页面验证

如果多个页面涉及同一数据模型：
- 合并字段列表
- 去重和规范化
- 识别字段的必填/可选属性

#### 5.4 生成数据库文件

**输出位置**：`assets/database/`
**文件命名**：使用模型名称，如 `users.json`、`订单表.json`

**文件格式**：
```json
{
  "tableName": "表名（中文）",
  "records": [
    { "id": 1, "字段1": "值1", "字段2": "值2" }
  ]
}
```

**关键原则**：
- **字段名优先使用中文**，与原型页面显示的字段名完全一致
- **保持命名一致性**：同一字段在不同表中使用相同名称
- 从原型提取真实数据，不足时生成合理的模拟数据
- 每个表生成 10-30 条记录，确保数据多样性
- 确保 id 字段唯一，数值类型不加引号

### 阶段 6：生成项目文档

#### 6.1 站点地图文档

将站点地图转换为 Markdown 文档：
- 保持页面层级结构
- 每个页面名称必须是可点击的链接，指向原型中对应的页面 URL
- 统计页面数量和主要功能模块

**输出位置**：`assets/docs/`

#### 6.2 项目简介文档

基于提取的信息生成项目概览：
- 基本信息（项目名称、页面数量、功能模块）
- 设计风格（主色调、字体、设计风格）
- 数据模型概览

**输出位置**：`assets/docs/`


### 阶段 7：页面还原

#### 7.1 选择还原页面

- 如果用户指定页面：使用用户指定的页面
- 如果用户未指定：从站点地图选择 1-2 个核心页面（优先视觉丰富、功能完整的页面）

#### 7.2 获取页面数据

**必需数据**：
1. **截图**：使用 `get_axure_screenshot`（推荐 `storeBase64: true`）
2. **主题**：使用 `get_page_theme`（如之前未获取）
3. **文本**：使用 `get_axure_text`

**可选数据**（根据需要）：
4. **节点**：使用 `get_axure_html`（仅在页面结构复杂或需要精确还原时）
5. **交互**：使用 `get_axure_interactions`（仅在页面包含复杂交互时）
6. **图片**：使用 `get_axure_image`（仅在需要下载图片资源时）

**数据获取原则**：
- 截图是视觉还原的主要依据
- 主题提供设计 tokens
- 文本提供准确的文案内容
- 节点数据量大，仅在必要时获取
- 优先使用截图+主题+文本的组合，避免过度依赖节点数据

#### 7.3 还原策略

**还原优先级**：
1. **截图**（最高优先级）：视觉识别布局、颜色、间距
2. **主题**：应用提取的 design tokens
3. **文本**：填充准确的文案内容
4. **节点**（可选）：补充细节和精确定位

**还原输出**：
- 生成符合 `development-standards.md` 和 `axure-api-guide.md` 和  规范的页面组件
- 页面还原完成后，需按开发规范验收

## 用户交互指南

### 初始对话

```
您好！我可以帮您从 Axure 原型中提取资产和还原页面。

请提供原型链接，我将为您：
1. 提取设计主题
2. 识别数据模型
3. 生成项目文档
4. 还原示例页面

请提供原型 URL，或告诉我您的具体需求。
```

### 环境检测失败

```
⚠️ 检测到 Axhub MCP 未安装或配置有误。
请先安装 Axhub MCP 扩展才能继续。
```

### 需求确认

```
✓ 已获取原型站点地图，共 [X] 个页面。

默认方案：
- 从核心页面提取设计主题
- 识别数据模型
- 生成项目文档
- 还原 1-2 个示例页面

回复"接受"按默认方案执行，或告诉我您的具体需求。
```

### 进度通知

```
正在处理...
✓ 已获取站点地图
✓ 已提取主题数据
⏳ 正在分析数据模型...
```

### 完成总结

```
✅ 已完成！

生成的资产：
- 设计主题
- 数据模型
- 项目文档
- 还原页面

后续建议：
如需还原更多页面，请告诉我页面名称

💡 我还可以为您生成业务文档（领域模型、业务流程、状态模型等），需要吗？
```

### 关键原则

- 主动确认重要操作
- 及时反馈进度
- 清晰总结成果
- 提供选项而非强制
- 友好处理错误
- 引导后续操作

## ⚠️ 注意事项

- HTML 结构数据量大，仅在必要时获取
- 主题提取建议使用 3-5 个页面
- 数据模型识别需要跨页面验证
- 页面还原以截图为主要依据
- 及时反馈进度，提供选项而非强制执行
- 尊重原型版权，提取的资产仅用于学习和开发
- 不要未经授权分发原型内容

## 📚 参考资源

- **主题生成规范**：`theme-generation-guide.md`
- **Axure API 指南**：`axure-api-guide.md`
- **开发标准**：`development-standards.md`

## 📝 业务文档生成指南

当用户请求生成业务文档时，根据已提取数据尝试生成以下文档：

1. **Domain Model（业务领域模型）** - 核心业务对象、字段含义、对象关系
2. **Business Relationship Model（业务关系模型）** - 对象间业务关联和逻辑
3. **Business Flow / Process（业务流程模型）** - 用户/系统操作顺序、页面流
4. **State Machine / Lifecycle（状态与生命周期模型）** - 业务对象状态及流转规则
5. **Permission / Access Model（权限模型）** - 角色与权限、操作可见性

**生成策略**：不要提前评估可行性，当用户请求时直接尝试生成，数据不足时明确告知原因。输出位置：`assets/docs/`