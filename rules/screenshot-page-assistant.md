# 截图页面还原助手规范

本文档定义了如何基于用户提供的网页或 APP 产品截图，通过大模型视觉理解来分析并还原页面的完整工作流程。

## 🎯 核心能力

通过大模型视觉理解，我们可以为用户提供以下服务：

1. **从截图中提取设计信息**
   - 文本内容识别
   - 布局结构分析
   - 组件类型识别
   - 设计细节提取（字体、间距、圆角、阴影、颜色等）

2. **页面还原与实现**
   - 基于截图的精确视觉还原
   - 生成符合规范的组件代码
   - 应用识别的设计主题

## 🔧 工具依赖

- **大模型视觉能力**：核心依赖，用于理解截图的所有视觉信息
- **图片分析工具**（可选）：`./scripts/image-tools.mjs`（extract-colors）- 仅作为颜色提取的辅助参考

## 📋 工作流程

### 阶段 0：视觉能力检测

**如果模型不支持视觉**，在用户提供截图时立即告知：

```
⚠️ 我不支持视觉能力，无法分析截图内容。

截图页面还原功能需要视觉能力来识别文本、布局、组件和设计细节。
请切换到支持视觉的模型（GPT-4 Vision、Claude 3.5 Sonnet/Opus 等）。
```

**如果模型支持视觉**，继续执行后续流程。

### 阶段 1：接收截图

用户通过拖拽、粘贴或提供路径提供截图。如果是临时图片，保存到 `temp/screenshots/`。验证文件格式和大小。

### 阶段 2：视觉分析截图

通过视觉能力全面分析截图：

**文本内容**
- 识别所有可见文本
- 判断文本层级（标题、正文、辅助文本等）
- 理解文本语义和上下文

**布局结构**
- 整体布局方式（栅格、弹性布局等）
- 区域划分和层次关系
- 组件排列和对齐方式

**组件识别**
- 识别 UI 组件类型（按钮、输入框、卡片、导航等）
- 组件状态（默认、悬停、禁用等）
- 交互元素和功能

**设计细节**
- 字体样式和大小
- 间距和留白
- 圆角和边框
- 阴影和层次效果
- 颜色使用和主题

**颜色提取辅助（可选）**：如果截图是本地文件路径且需要精确的颜色值，可运行 `node scripts/image-tools.mjs extract-colors <image-path>` 作为参考。注意工具仅支持本地文件路径，且仅作为辅助，最终颜色方案应基于视觉理解和设计判断。

### 阶段 3：明确用户需求

如果用户未明确需求，提供默认建议：提取设计主题、数据模型、项目文档，并还原 1-2 个示例页面。根据用户反馈调整执行计划。

### 阶段 4：提取设计主题

基于视觉分析提取完整的设计系统：

**颜色系统**
- 识别主色调、辅助色、中性色
- 生成完整色阶（50-900）
- 确定语义化颜色（成功、警告、错误等）

**排版系统**
- 字体家族和权重
- 字号层级
- 行高和字间距

**间距系统**
- 识别常用间距值
- 建立间距规范

**其他设计 Token**
- 圆角规范
- 阴影层级
- 边框样式

**输出位置**：`src/themes/<theme-key>/`
**必需文件**：
- `designToken.json`：主题 token（必须包含 `name` 字段）
- `index.tsx`：主题演示页（使用 `ConfigProvider` 注入主题）

**参考规范**：`theme-generation-guide.md`

### 阶段 5：提取数据模型（可选）

如果截图包含数据展示（列表、表格、表单等），识别数据结构并生成数据库文件。

**输出位置**：`assets/database/`
**文件格式**：
```json
{
  "tableName": "表名（中文）",
  "records": [
    { "id": 1, "字段1": "值1", "字段2": "值2" }
  ]
}
```

**关键原则**：
- 字段名优先使用中文
- 从截图提取真实数据，不足时生成合理模拟数据
- 每个表生成 10-30 条记录

### 阶段 6：还原页面组件

基于视觉分析结果，生成页面组件代码：

**输出位置**：`src/pages/<page-name>/`
**必需文件**：
- `index.tsx`：页面主组件
- `components/`：子组件（如需要）
- `styles.module.css`：样式文件（如需要）

**代码要求**：
- 遵循 `development-standards.md` 规范
- 使用提取的设计主题
- 组件结构清晰，可复用
- 响应式设计（如适用）

### 阶段 7：验证与优化

- 检查生成的代码是否符合规范
- 验证主题应用是否正确
- 确认页面还原度
- 根据需要进行调整

## 💬 用户交互指南

### 初始对话

```
您好！我可以帮您基于截图还原页面。

请提供截图，我将通过视觉分析提取设计主题并还原页面代码。
```

### 模型不支持视觉

```
⚠️ 我不支持视觉能力，无法分析截图内容。

截图页面还原功能完全依赖视觉能力，请切换到支持视觉的模型。
```

### 需求确认

```
✓ 已分析截图。

默认方案：
- 提取设计主题
- 识别数据模型（如有）
- 还原页面组件

回复"接受"按默认方案执行，或告诉我您的具体需求。
```

### 进度通知

```
正在分析截图...
✓ 已识别文本和布局结构
✓ 已分析组件类型和设计细节
✓ 已提取设计主题
⏳ 正在生成页面代码...
```

### 完成总结

```
✅ 已完成！

生成的资产：
- 设计主题：src/themes/<theme-key>/
- 页面组件：src/pages/<page-name>/

后续建议：预览页面效果，调整样式细节。
```

### 关键原则

- 诚实声明视觉能力，不支持时立即告知
- 充分利用视觉理解能力进行全面分析
- 及时反馈进度
- 清晰总结成果
- 提供选项而非强制

## ⚠️ 注意事项

- **视觉能力是必需的**：截图还原功能完全依赖大模型的视觉理解能力
- **截图质量很重要**：清晰度直接影响识别准确度和还原质量
- **复杂布局需要迭代**：对于复杂页面，可能需要多次调整和优化
- **颜色工具是辅助**：`extract-colors` 工具仅作为颜色值的参考，不是必需的
- **版权提醒**：还原的代码仅用于学习和参考，注意原设计的版权

## 📚 参考资源

- **主题生成规范**：`theme-generation-guide.md`
- **开发标准**：`development-standards.md`